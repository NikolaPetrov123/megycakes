<!DOCTYPE html>
<html lang="en" th:replace="~{fragments/layout :: layout (~{::title}, ~{::section})}">
<head>
  <title>Review your order</title>
</head>
<body>
<section class="max-w-3xl mx-auto p-4" th:with="o=${order}">
  <h1 class="text-2xl font-bold mb-4">Review your order</h1>

  <div class="mb-4 text-sm text-stone-600">
    <div><span class="font-medium">Order #:</span> <span th:text="${o.orderNumber}">ORDERNUM</span></div>
    <div><span class="font-medium">Status:</span> <span th:text="${o.status}">NEW</span></div>
    <div><span class="font-medium">Customer:</span> <span th:text="${o.getCustomerName()}">Name</span> • <span th:text="${o.getCustomerEmail()}">email@example.com</span></div>
    <div th:if="${!o.delivery}">
      <span class="font-medium">Shipping:</span>
      <span th:text="${o.addressLine1}">Addr1</span>
      <span th:if="${o.addressLine2}" th:text="' • ' + ${o.addressLine2}"></span>
      <span th:text="' • ' + ${o.postalCode} + ' ' + ${o.city} + ', ' + ${o.country}"></span>
    </div>
    <div th:if="${o.pickup}">
      <span class="font-medium">Pickup:</span> Yes
    </div>
  </div>

  <table class="w-full text-sm mb-4">
    <thead class="text-left border-b">
    <tr>
      <th class="py-2">Item</th>
      <th class="py-2">Qty</th>
      <th class="py-2">Price</th>
      <th class="py-2">Line Total</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="it : ${o.getItems()}" class="border-b">
      <td class="py-2" th:text="${it.getNameSnapshot()}">Chocolate Cake</td>
      <td class="py-2" th:text="${it.quantity}">1</td>
      <td class="py-2" th:text="|${#numbers.formatDecimal(it.getPriceCentsSnapshot() / 100,1,2)}${order.currency}|">0.00</td>
      <td class="py-2" th:text="|${#numbers.formatDecimal(it.getPriceCentsSnapshot()*it.quantity / 100,1,2)}${order.currency}|">0.00</td>
    </tr>
    </tbody>
  </table>

  <div class="flex items-center justify-between text-lg font-semibold mb-6">
    <span>Total</span>
    <span th:text="|${#numbers.formatDecimal(order.totalCents / 100.0,1,2)} ${order.currency}|"></span>
  </div>

  <form th:action="@{|/order/${o.orderNumber}/confirm|}" method="post" class="flex gap-2">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
    <a th:href="@{/cart}" class="px-4 py-2 border rounded">Back to cart</a>
    <button type="submit" class="px-4 py-2 bg-stone-900 text-white rounded">Confirm order</button>
  </form>
</section>
</body>
</html>